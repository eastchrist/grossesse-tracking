

<!--  *****Plcs  -->
<script type="text/javascript">
    RED.nodes.registerType('Plcs',{
        color:'rgb(176, 223, 227)',
        category: 'Plc',
        defaults: {
            name: {value:""},
            Area : {value:""},
            outputs: {value:1}  //,
            //noerr: {value:0,required:true,validate:function(v) { return !v; }}
        },
        inputs:1,
        outputs:1,
        icon: "function.svg",
        label: function() {
            return this.name || "";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;

            // To fill the Selector Option
            var Checking = "area";
            var Select_values = [];
            var candidateNodes = RED.nodes.filterNodes({z:node.z});
            candidateNodes.forEach(function(n) {
                var nodeDef = RED.nodes.getType(n.type);
                var label;
                var sublabel;
                if (nodeDef) {
                    var l = nodeDef.label;
                    label = (typeof l === "function" ? l.call(n) : l)||"";
                    sublabel = n.type;
                    if (sublabel.indexOf("subflow:") === 0) {
                        var subflowId = sublabel.substring(8);
                        var subflow = RED.nodes.subflow(subflowId);
                        sublabel = "subflow : "+subflow.name;
                    }
                    if (sublabel === Checking) {
                        Select_values.push({value:label, text:label});
                    }
                }
            });
            for (var i = 0; i < Select_values.length; i++) {
               var value = Select_values[i].value;
               var text = Select_values[i].text;
               $('#node-input-Area').append($("<option></option>").attr("value", value).text(text));
            };
            // Make sure the selected value is also selected in the <select> tag
            $('#node-input-Area').val(this.Area);


            $( "#node-input-outputs" ).spinner({
                min:0,
                change: function(event, ui) {
                    var value = this.value;
                    if (!value.match(/^\d+$/)) { value = 1;  }
                    else if (value < this.min) { value = this.min; }
                    if (value !== this.value) { $(this).spinner("value", value); }
                }
            });
        },
        oneditsave: function() {
            //var node = this;
            //var noerr = 0;
            //$("#node-input-noerr").val(0);
        }
    });
</script>
<script type="text/html" data-template-name="Plcs">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row" >
        <label for="node-input-Area"><i class="fa fa-tag"></i><span data-i18n="file_conf.label.area"></span></label>
        <select type="text" id="node-input-Area" style="margin-left:11px; width:200px;">        <!--  height:28px;  -->
        </select>
    </div>

    <div class="form-row" style="margin-bottom: 0px">
        <label for="node-input-outputs"><i class="fa fa-random"></i> </i> Outputs</label>
        <input id="node-input-outputs" style="width: 60px;" value="1">
    </div>
</script>
<script type="text/html" data-help-name="Plcs">
    <p>Configuration of factory Plc list.</p>
</script>
<!--  *****Server  -->
<script type="text/javascript">
    RED.nodes.registerType('Server_Def',{
        category: 'config',
        defaults: {
            name: {value:""},
            Server_Type: {value: ""}
        },
        label: function() {
            return this.name || "";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
        },
        oneditsave: function() {
            var node = this;
        }
    });
</script>
<script type="text/html" data-template-name="Server_Def">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>

    <div class="form-row" style="margin-top:12px; margin-bottom:0;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="file_conf.label.Server"></span></label>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Server_Type"></span>
        <select type="text" id="node-config-input-Server_Type" style="margin-left:11px; width:200px;">      <!--  height:28px;  -->
            <option value="snap7" data-i18n="file_conf.Server_Type.snap7"></option>
            <option value="opc_ua" data-i18n="file_conf.Server_Type.opc_ua"></option>
            <option value="opc_da" data-i18n="file_conf.Server_Type.opc_da"></option>
        </select>
    </div>


</script>
<!--  *****Plc  -->
<script type="text/javascript">
    RED.nodes.registerType('Plc_Type',{
        color:'rgb(176, 223, 227)',
        category: 'Plc',
        defaults: {
            name: {value:""},
            Plc_Brand: {value:""},
            Plc_Connection: {value:""},
            Plc_Slot: {value: ""},
            Plc_Rack: {value: ""},
            Plc_Ip: {value: ""},
            Server_Def: {value:"", type:"Server_Def"},
            Area : {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "function.svg",
        label: function() {
            return this.name || "";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;

            // To fill the Selector Option
            var Checking = "area";
            var Select_values = [];
            var candidateNodes = RED.nodes.filterNodes({z:node.z});
            candidateNodes.forEach(function(n) {
                var nodeDef = RED.nodes.getType(n.type);
                var label;
                var sublabel;
                if (nodeDef) {
                    var l = nodeDef.label;
                    label = (typeof l === "function" ? l.call(n) : l)||"";
                    sublabel = n.type;
                    if (sublabel.indexOf("subflow:") === 0) {
                        var subflowId = sublabel.substring(8);
                        var subflow = RED.nodes.subflow(subflowId);
                        sublabel = "subflow : "+subflow.name;
                    }
                    if (sublabel === Checking) {
                        Select_values.push({value:label, text:label});
                    }
                }
            });
            for (var i = 0; i < Select_values.length; i++) {
               var value = Select_values[i].value;
               var text = Select_values[i].text;
               $('#node-input-Area').append($("<option></option>").attr("value", value).text(text));
            };
            // Make sure the selected value is also selected in the <select> tag
            $('#node-input-Area').val(this.Area);
        },
        oneditsave: function() {

        }
    });
</script>
<script type="text/html" data-template-name="Plc_Type">

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row" >
        <label for="node-input-Area"><i class="fa fa-tag"></i><span data-i18n="file_conf.label.area"></span></label>
        <select type="text" id="node-input-Area" style="margin-left:11px; width:200px;">        <!--  height:28px;  -->
        </select>
    </div>

    <div class="form-row" style="margin-top:12px; margin-bottom:0;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="file_conf.label.Plc"></span></label>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Plc_Brand"></span>
        <select type="text" id="node-input-Plc_Brand" style="margin-left:11px; width:200px;">       <!--  height:28px;  -->
            <option value="siemens" data-i18n="file_conf.Plc_Brand.siemens"></option>
            <option value="rockwell" data-i18n="file_conf.Plc_Brand.rockwell"></option>
            <option value="telemecanique" data-i18n="file_conf.Plc_Brand.telemecanique"></option>
        </select>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Plc_Connection"></span>
        <select type="text" id="node-input-Plc_Connection" style="margin-left:11px; width:200px;">      <!--  height:28px;  -->
            <option value="ethernet" data-i18n="file_conf.Plc_Connection.ethernet"></option>
            <option value="profibus" data-i18n="file_conf.Plc_Connection.profibus"></option>
            <option value="DH+" data-i18n="file_conf.Plc_Connection.DH+"></option>
        </select>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Plc_Slot"></span>
        <select type="text" id="node-input-Plc_Slot" style="margin-left:11px; width:200px;">            <!--  height:28px;  -->
            <option value="0" data-i18n="file_conf.Plc_Slot.0"></option>
            <option value="1" data-i18n="file_conf.Plc_Slot.1"></option>
            <option value="2" data-i18n="file_conf.Plc_Slot.2"></option>
            <option value="3" data-i18n="file_conf.Plc_Slot.3"></option>
            <option value="4" data-i18n="file_conf.Plc_Slot.4"></option>
            <option value="5" data-i18n="file_conf.Plc_Slot.5"></option>
            <option value="6" data-i18n="file_conf.Plc_Slot.6"></option>
            <option value="7" data-i18n="file_conf.Plc_Slot.7"></option>
        </select>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Plc_Rack"></span>
        <select type="text" id="node-input-Plc_Rack" style="margin-left:11px; width:200px;">        <!--  height:28px;  -->
            <option value="0" data-i18n="file_conf.Plc_Rack.0"></option>
            <option value="1" data-i18n="file_conf.Plc_Rack.1"></option>
            <option value="2" data-i18n="file_conf.Plc_Rack.2"></option>
            <option value="3" data-i18n="file_conf.Plc_Rack.3"></option>
            <option value="4" data-i18n="file_conf.Plc_Rack.4"></option>
            <option value="5" data-i18n="file_conf.Plc_Rack.5"></option>
            <option value="6" data-i18n="file_conf.Plc_Rack.6"></option>
            <option value="7" data-i18n="file_conf.Plc_Rack.7"></option>
        </select>
    </div>
    <div class="form-row" style="padding-left:18px; margin-bottom:4px;">
        <span data-i18n="file_conf.label.Plc_Ip"></span>
        <input type="text" id="node-input-Plc_Ip">
    </div>

    <div class="form-row">
        <label for="node-input-Server_Def"><i class="fa fa-table"></i> Server_Def</label>
        <input type="text" id="node-input-Server_Def">
    </div>
</script>
<script type="text/html" data-help-name="Plc_Type">
    <p>Configuration of one Plc.</p>
</script>

